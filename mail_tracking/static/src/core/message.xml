<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">
    <t t-inherit="mail.Message" t-inherit-mode="extension">
      <xpath expr="//div[@t-ref='messageContent']/div[hasclass('o-mail-Message-header')]" position="inside">
        <span
        t-if="this.props.thread.type == 'mailbox' and this.props.thread.id == 'failed'"
        t-attf-class="o-mail-ThreadIcon"
    >
        <a
            href="#"
            class="btn btn-link btn-success o_thread_icon text-muted btn-sm o_failed_message_reviewed o_activity_link"
            role="button"
            t-on-click="_onMarkFailedMessageReviewed"
            t-att-data-message-id="this.message.id"
        >
            <i class="fa fa-check" role="img" aria-label="Set As Reviewed" />
            Set as Reviewed
        </a>
        <a
            href="#"
            class="btn btn-link btn-success o_thread_icon text-muted btn-sm o_failed_message_retry o_activity_link"
            role="button"
            t-on-click="_onRetryFailedMessage"
            t-att-data-message-id="this.message.id"
        >
            <i class="fa fa-retweet" role="img" aria-label="Retry" />
            Retry
        </a>
    </span>
      </xpath>
        <xpath expr="//div[@t-ref='messageContent']/div[hasclass('o-mail-Message-header')]" position="after">
            <span class="o-mail-MessageSeenIndicator position-relative d-flex opacity-50">
                <p t-if='PartnerTrackings.length > 0'>
                  <strong>To:</strong>
                  <t t-foreach="PartnerTrackings" t-as="tracking" t-key="tracking_index">
                    <t t-if="!tracking_first">
                      -
                    </t>
                    <a
                              t-if="tracking['partner_id']"
                              t-attf-class="o_mail_action_tracking_partner #{tracking['isCc'] ? 'o_mail_cc' : ''}"
                              t-att-data-partner="tracking['partner_id']"
                              t-attf-href="#model=res.partner&amp;id={{tracking['partner_id']}}"
                              t-out="tracking['recipient']"
                          />
                <span
                              t-else=""
                              t-attf-class="#{tracking['isCc'] ? 'o_mail_cc' : ''}"
                              t-out="tracking['recipient']"
                          />
                <t
                              t-if="tracking['status'] === 'error' &amp;&amp; tracking['error_type'] === 'no_recipient'"
                              t-set="title_status"
                              t-value="tracking['error_description']"
                          />
                <t t-else="" t-set="title_status" t-value="tracking['status_human']" />
                <span
                              class="mail_tracking o_mail_action_tracking_status"
                              t-att-data-tracking="tracking['tracking_id']"
                              t-att-title="title_status"
                              type="button"
                              t-on-click="_onTrackingStatusClick"
                          >
                    <t t-call="mail_tracking.TrackingStatus" />
                </span>
                  </t>
                </p>
              </span>
        </xpath>
    </t>

    <t t-name="mail_tracking.TrackingStatus">
        <span t-if="tracking['isCc']" class="mail_tracking_cc">
            <i class="fa fa-cc" role="img" aria-label="Cc" />
        </span>
        <span
              t-elif="!tracking['isCc'] &amp;&amp; !tracking['partner_id']"
              class="mail_anon_recipient"
          >
            <i class="fa fa-low-vision" role="img" aria-label="Anonymous Recipient" />
        </span>
        <span t-elif="tracking['status'] === 'unknown'" class="mail_tracking_unknown">
            <i class="fa fa-ban" role="img" aria-label="Unknown Status" />
        </span>
        <span
              t-elif="tracking['status'] === 'waiting'"
              class="mail_tracking_waiting mail_tracking_pointer"
          >
            <i class="fa fa-clock-o" role="img" aria-label="Waiting Status" />
        </span>
        <span
              t-elif="tracking['status'] === 'error'"
              class="mail_tracking_error mail_tracking_pointer"
          >
            <i
                  t-if="tracking['error_type'] === 'no_recipient'"
                  class="fa fa-user-times"
                  role="img"
                  aria-label="Error Status"
              />
            <i t-else="" class="fa fa-remove" />
        </span>
        <span
              t-elif="tracking['status'] === 'sent'"
              class="mail_tracking_sent mail_tracking_pointer"
          >
            <i class="fa fa-check" role="img" aria-label="Sent Status" />
        </span>
        <span
              t-elif="tracking['status'] === 'delivered'"
              class="fa-stack mail_tracking_delivered mail_tracking_pointer"
          >
            <i
                  class="fa fa-check fa-stack-1x"
                  style="margin-left:1px"
                  role="img"
                  aria-label="Delivered Status Left Checkmark"
              />
            <i
                  class="fa fa-check fa-inverse fa-stack-1x"
                  style="margin-left:-2px;"
                  role="img"
                  aria-label="Delivered Status Center Checkmark"
              />
            <i
                  class="fa fa-check fa-stack-1x"
                  style="margin-left:-3px"
                  role="img"
                  aria-label="Delivered Status Right Checkmark"
              />
        </span>
        <span
              t-elif="tracking['status'] === 'opened'"
              class="fa-stack mail_tracking_opened mail_tracking_pointer"
          >
            <i
                  class="fa fa-check fa-stack-1x"
                  style="margin-left:1px"
                  role="img"
                  aria-label="Opened Status Left Checkmark"
              />
            <i
                  class="fa fa-check fa-inverse fa-stack-1x"
                  style="margin-left:-2px;"
                  role="img"
                  aria-label="Opened Status Center Checkmark"
              />
            <i
                  class="fa fa-check fa-stack-1x"
                  style="margin-left:-3px"
                  role="img"
                  aria-label="Opened Status Right Checkmark"
              />
        </span>
    </t>
    
</templates>